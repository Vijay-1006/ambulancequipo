<?php
require_once('config.php');
$query1 = $con->prepare('SELECT DISTINCT city FROM management ORDER BY city');
$query1->execute();
$sqldata1 = $query1->fetchAll(PDO::FETCH_ASSOC);
$hierarchy = '';
$citiesList = array();
foreach($sqldata1 as $row1)
{
    array_push($citiesList, $row1["city"]);
}
foreach($citiesList as $city)
{
    $hierarchy .= "<li class='sub-nav open'>
                        <a href='#'>
                            <svg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='16' height='16' viewBox='0 0 172 172' style=' fill:#000000;'><g fill='none' fill-rule='nonzero' stroke='none' stroke-width='1' stroke-linecap='butt' stroke-linejoin='miter' stroke-miterlimit='10' stroke-dasharray='' stroke-dashoffset='0' font-family='none' font-weight='none' font-size='none' text-anchor='none' style='mix-blend-mode: normal'><path d='M0,172v-172h172v172z' fill='none'></path><g fill='#ffffff'><path d='M86,10.75c-26.07715,0 -47.19922,21.70996 -47.19922,48.16504c0,17.46875 11.21192,35.94531 21.91993,50.76855c10.75,14.78125 21.41601,25.69922 21.41601,25.69922c1.0498,1.0498 2.43555,1.6377 3.86328,1.6377c1.42774,0 2.81348,-0.5879 3.86328,-1.6377c0,0 10.66602,-10.91797 21.37402,-25.69922c10.75,-14.82324 21.96192,-33.2998 21.96192,-50.76855c0,-26.49707 -21.12207,-48.16504 -47.19922,-48.16504zM86,21.5c20.11426,0 36.44922,16.62891 36.44922,37.41504c0,12.47168 -9.7002,30.36035 -19.90429,44.46973c-8.27247,11.42188 -13.73145,16.92284 -16.54493,19.90429c-2.81348,-2.98145 -8.27246,-8.48242 -16.54492,-19.90429c-10.2041,-14.10937 -19.9043,-31.99805 -19.9043,-44.46973c0,-20.78614 16.33496,-37.41504 36.44922,-37.41504zM86,43c-5.9209,0 -10.75,4.8291 -10.75,10.75c0,5.9209 4.8291,10.75 10.75,10.75c5.9209,0 10.75,-4.8291 10.75,-10.75c0,-5.9209 -4.8291,-10.75 -10.75,-10.75zM48.375,111.48926c-16.04101,4.24121 -26.875,11.37989 -26.875,22.21386c0,18.09864 32.45996,27.54688 64.5,27.54688c32.04004,0 64.5,-9.44824 64.5,-27.54687c0,-10.91797 -10.58203,-17.88867 -26.83301,-22.17187l-6.88672,9.49024c14.73926,3.44335 22.96973,8.31445 22.96973,12.68164c0,6.84473 -20.9541,16.79688 -53.75,16.79688c-32.7959,0 -53.75,-9.95215 -53.75,-16.79687c0,-4.3252 8.23047,-9.28027 22.75977,-12.72364z'></path></g></g></svg>
                            <span>$city</span>
                        </a>
                        <ul>";
    $query2 = $con->prepare('SELECT * FROM management WHERE city=:city ORDER BY name');
    $query2->bindParam(':city', $city);
    $query2->execute();
    $sqldata2 = $query2->fetchAll(PDO::FETCH_ASSOC);
    foreach($sqldata2 as $row2)
    {
        $managementName = $row2["name"];
        $hierarchy .= "<li class='group-lvl sub-nav open'>
                            <a href='#'>
                                <svg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='16' height='16' viewBox='0 0 172 172' style=' fill:#000000;'><g fill='none' fill-rule='nonzero' stroke='none' stroke-width='1' stroke-linecap='butt' stroke-linejoin='miter' stroke-miterlimit='10' stroke-dasharray='' stroke-dashoffset='0' font-family='none' font-weight='none' font-size='none' text-anchor='none' style='mix-blend-mode: normal'><path d='M0,172v-172h172v172z' fill='none'></path><g fill='#ffffff'><path d='M80.625,21.5c-2.96841,0.0003 -5.3747,2.40659 -5.375,5.375v16.125h-37.625c-2.96841,0.0003 -5.3747,2.40659 -5.375,5.375v37.625h-5.375c-2.96841,0.0003 -5.3747,2.40659 -5.375,5.375v59.125h10.75v-53.75h43v53.75h10.75v-118.25h53.75v118.25h10.75v-123.625c-0.0003,-2.96841 -2.40659,-5.3747 -5.375,-5.375zM96.75,43v10.75h10.75v-10.75zM118.25,43v10.75h10.75v-10.75zM43,53.75h32.25v32.25h-32.25zM53.75,64.5v10.75h10.75v-10.75zM96.75,64.5v10.75h10.75v-10.75zM118.25,64.5v10.75h10.75v-10.75zM96.75,86v10.75h10.75v-10.75zM118.25,86v10.75h10.75v-10.75zM43,107.5v10.75h21.5v-10.75zM96.75,107.5v10.75h10.75v-10.75zM118.25,107.5v10.75h10.75v-10.75zM43,129v10.75h21.5v-10.75zM96.75,129v10.75h10.75v-10.75zM118.25,129v10.75h10.75v-10.75z'></path></g></g></svg>
                                <span>$managementName</span>
                            </a>
                            <ul>";
        $query3 = $con->prepare('SELECT ambulanceNo FROM driver WHERE managementID=:managementID');
        $query3->bindParam(':managementID', $row2['managementID']);
        $query3->execute();
        $sqldata3 = $query3->fetchAll(PDO::FETCH_ASSOC);
        foreach($sqldata3 as $row3)
        {
            $ambulanceNo = $row3["ambulanceNo"];
            $hierarchy .= "<li>
                                <a href='#'>
                                    <svg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='16' height='16' viewBox='0 0 172 172' style=' fill:#000000;'><g fill='none' fill-rule='nonzero' stroke='none' stroke-width='1' stroke-linecap='butt' stroke-linejoin='miter' stroke-miterlimit='10' stroke-dasharray='' stroke-dashoffset='0' font-family='none' font-weight='none' font-size='none' text-anchor='none' style='mix-blend-mode: normal'><path d='M0,172v-172h172v172z' fill='none'></path><g fill='#ffffff'><path d='M89.44,0c-1.89469,0 -3.44,1.54531 -3.44,3.44v6.88c0,1.89469 1.54531,3.44 3.44,3.44c1.90813,0 3.44,-1.54531 3.44,-3.44v-6.88c0,-1.89469 -1.53187,-3.44 -3.44,-3.44zM65.145,10.105c-0.87344,0 -1.80062,0.29563 -2.4725,0.9675c-1.34375,1.34375 -1.34375,3.49375 0,4.8375l4.8375,4.945c0.67188,0.67188 1.58563,0.9675 2.4725,0.9675c0.88688,0 1.80063,-0.29562 2.4725,-0.9675c1.34375,-1.34375 1.34375,-3.60125 0,-4.945l-4.945,-4.8375c-0.67187,-0.67187 -1.49156,-0.9675 -2.365,-0.9675zM113.735,10.105c-0.87344,0 -1.69312,0.29563 -2.365,0.9675l-4.945,4.8375c-1.34375,1.34375 -1.34375,3.60125 0,4.945c0.67188,0.67188 1.58563,0.9675 2.4725,0.9675c0.88688,0 1.80063,-0.29562 2.4725,-0.9675l4.8375,-4.945c1.34375,-1.34375 1.34375,-3.49375 0,-4.8375c-0.67187,-0.67187 -1.59906,-0.9675 -2.4725,-0.9675zM89.44,20.64c-7.59219,0 -13.76,6.16781 -13.76,13.76v3.44h27.52v-3.44c0,-7.59219 -6.16781,-13.76 -13.76,-13.76zM55.04,30.96c-1.89469,0 -3.44,1.54531 -3.44,3.44c0,1.89469 1.54531,3.44 3.44,3.44h6.88c1.89469,0 3.44,-1.54531 3.44,-3.44c0,-1.89469 -1.54531,-3.44 -3.44,-3.44zM116.96,30.96c-1.90812,0 -3.44,1.54531 -3.44,3.44c0,1.89469 1.53188,3.44 3.44,3.44h6.88c1.90813,0 3.44,-1.54531 3.44,-3.44c0,-1.89469 -1.53187,-3.44 -3.44,-3.44zM9.5675,44.72c-5.25406,0 -9.5675,4.24625 -9.5675,9.46v84.28c0,5.21375 4.31344,9.46 9.5675,9.46h14.5125c0,11.38156 9.25844,20.64 20.64,20.64c11.38156,0 20.64,-9.25844 20.64,-20.64h48.16c0,11.38156 9.25844,20.64 20.64,20.64c11.38156,0 20.64,-9.25844 20.64,-20.64h7.6325c5.25406,0 9.5675,-4.24625 9.5675,-9.46v-24.08c0,-6.62469 -4.71656,-13.37031 -5.16,-13.975l-31.0675,-48.0525c-0.08062,-0.12094 -0.22844,-0.3225 -0.3225,-0.43l-0.645,-0.645c-2.66062,-3.19812 -5.32125,-6.5575 -11.0725,-6.5575zM110.08,61.92h23.5425l24.6175,37.84h-48.16zM48.16,72.24h6.88v13.76h13.76v6.88h-13.76v13.76h-6.88v-13.76h-13.76v-6.88h13.76zM44.72,134.16c7.59219,0 13.76,6.16781 13.76,13.76c0,7.59219 -6.16781,13.76 -13.76,13.76c-7.59219,0 -13.76,-6.16781 -13.76,-13.76c0,-7.59219 6.16781,-13.76 13.76,-13.76zM134.16,134.16c7.59219,0 13.76,6.16781 13.76,13.76c0,7.59219 -6.16781,13.76 -13.76,13.76c-7.59219,0 -13.76,-6.16781 -13.76,-13.76c0,-7.59219 6.16781,-13.76 13.76,-13.76z'></path></g></g></svg>
                                    <span>$ambulanceNo</span>
                                </a>
                            </li>";
        }
        $hierarchy .= "</ul></li>";
    }
    $hierarchy .= "</ul>";
}
$hierarchy .= "</li>";
echo $hierarchy;
?>